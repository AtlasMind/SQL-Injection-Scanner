# SQL Injection Script Write-Up

The provided Python script is a tool for testing SQL injection vulnerabilities in web applications. Let's break down its functionality, SQL queries, and error exploitation techniques.

## SQL Injection Testing (`-t` or `--test)

The script tests for SQL injection vulnerabilities by sending various payloads to the target URL. It constructs URLs with different payloads and observes error messages in the response to determine vulnerability.

- **Payloads used:**
  - `args.test + "'", args.test + '"', args.test[:-4] + ';', args.test + ")", args.test + "')", args.test + '")', args.test + '*'`

### Payloads Used:

1. `args.test + "'`:
   - **Description:** Appends a single quote to the user-provided input.
   - **Purpose:** Tests for SQL injection by potentially closing an open SQL string and generating an error if not handled correctly by the server.

2. `args.test + '"`:
   - **Description:** Appends a double quote to the user-provided input.
   - **Purpose:** Similar to the single quote payload, tests for SQL injection by potentially closing an open SQL string with a double quote.

3. `args.test[:-4] + ';'`:
   - **Description:** Truncates the last four characters from the user-provided input and appends a semicolon.
   - **Purpose:** Attempts to terminate an SQL statement prematurely by injecting a semicolon.

4. `args.test + ")`:
   - **Description:** Appends a closing parenthesis to the user-provided input.
   - **Purpose:** Tests if the server handles injected closing parentheses correctly. Can help identify SQL injection vulnerabilities.

5. `args.test + "')"`:
   - **Description:** Appends a single quote, closing parenthesis, and double quote to the user-provided input.
   - **Purpose:** Tests for SQL injection by combining characters that may lead to syntax errors in SQL statements.

6. `args.test + '")'`:
   - **Description:** Appends a double quote, closing parenthesis, and single quote to the user-provided input.
   - **Purpose:** Similar to the previous payload, tests for SQL injection with a different character order.

7. `args.test + '*'`:
   - **Description:** Appends an asterisk (*) to the user-provided input.
   - **Purpose:** Introduces a wildcard character to test how the server handles unexpected input. May trigger errors if not handled correctly.

These payloads are crafted to manipulate SQL queries on the server-side. The goal is to provoke errors in the SQL execution process, revealing potential vulnerabilities in the application's handling of user input. Each payload tests a specific scenario to identify weaknesses in SQL query parsing and execution.

- **Vulnerable Text:**
  - `['MySQL Query fail:', '/www/htdocs/', 'Query failed', 'mysqli_fetch_array()', 'mysqli_result', 'Warning: ', 'MySQL server', 'SQL syntax', 'You have an error in your SQL syntax;', 'mssql_query()', "Incorrect syntax near '='", 'mssql_num_rows()', 'Notice: ']`

The script checks for the presence of vulnerable text in the response. If any of the specified text is found, the script identifies the site as vulnerable.

## Extracting Table Names (`-tn` or `--tablenames`)

The script extracts table names from the database using an XPath-based error-based injection technique.

- **SQL Query:**
  - `extractvalue(1, (select group_concat(table_name) from information_schema.tables where table_schema=database()))`

- **Error Exploitation:**
  - The injection causes an error in the XPath query, and the error message leaks the concatenated table names.

## Extracting Column Names (`-c` or `--columns`)

The script extracts column names from a specified table using a union-based error-based injection technique.

- **SQL Query:**
  - `extractvalue(0x0a, concat(0x0a, (select column_name from information_schema.columns where table_schema=database() and table_name='" + args.colum_name + "' limit 0,1)))--"`

- **Error Exploitation:**
  - The injection causes an error in the `concat` function, and the error message leaks the column names.

## Getting Database Name (`-dbn` or `--dbname`)

The script retrieves the name of the database using an error-based injection.

- **SQL Query:**
  - `extractvalue(1, concat(1, (select database())))`

- **Error Exploitation:**
  - The injection causes an error, and the error message leaks the name of the database.

## Finding Database Type (`-gdt` or `--get_database_type`)

The script attempts to determine the backend database type by checking for specific error messages associated with different database systems.

- **Error Exploitation:**
  - It uses predefined signatures for MySQL, PostgreSQL, Microsoft SQL Server, Oracle, Advantage Database, and Firebird. If a signature is found in the error message, the script identifies the database type.

These techniques leverage errors generated by injected SQL queries to extract information about the database structure and system. It's important to note that these actions should only be performed on systems with proper authorization and for ethical, security testing purposes. Unauthorized SQL injection testing is illegal and can have serious consequences.
